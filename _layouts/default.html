<!DOCTYPE html>
<html lang="{{ site.lang | default: "es-MX" }}">
  <head>
    <meta charset="UTF-8">

{% seo %}
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="stylesheet" href="{{ '/assets/css/style.css?v=' | append: site.github.build_revision | relative_url }}">
  </head>
  <body>

    <header class="page-header" role="banner">
      <h2 class="project-tagline">Arrastra este bot√≥n al "bookmarks bar" y dale click cuando tengas el correo del horario abierto.</h2>
      <a href="javascript: (function(){function T(e,n){return("000000000"+e).substr(-n)}function u(e){var n=e.trim().split(" "),t=n[3];t+=T({ene:1,feb:2,mar:3,abr:4,may:5,jun:6,jul:7,ago:8,sep:9,oct:10,nov:11,dic:12}[n[2]],2)+T(n[0],2);var r=n[4].split(":");return t+"T"+T(r[0],2)+r[1]+"00"}function e(e){for(var n=e.nextElementSibling,t=[];n&&"#9bbad6"!==n.getAttribute("bgcolor");){if("#EEEEEE"===n.getAttribute("bgcolor")){var r,o=n.children[1].textContent.trim(),a=n.children[2].textContent,i=n.children[3].textContent.trim(),c=n.children[4].textContent.trim(),l=n.children[5].textContent.trim();"A-"==c.substr(0,2)&&(c=c.substr(2)),r=c==l?l:c+l,t.push({fechas:o,salon:r,horario:i,dias:a})}n=n.nextElementSibling}return t}String.prototype.format||(String.prototype.format=function(){var t=arguments;return this.replace(/{(\d+)}/g,function(e,n){return void 0!==t[n]?t[n]:e})});for(var n=document.getElementById("Item.MessageNormalizedBody")||document.querySelector("_rp_m5")||document.querySelector('[aria-label="Message Contents"]')||document.querySelector("mdpzkPPkhj9STdSHzJxnr")||document.querySelector(".ii.gt.adP.adO")||document.querySelector(".nH.aNW.apk.nn")||document.querySelector(".bk")||document,S=["SU","MO","TU","WE","TH","FR","SA"],m="BEGIN:VCALENDAR\nPRODID:-//Microsoft Corporation//Outlook 16.0 MIMEDIR//EN\nVERSION:2.0\nMETHOD:PUBLISH\nBEGIN:VTIMEZONE\nTZID:Central Standard Time\nBEGIN:STANDARD\nDTSTART:16011104T020000\nRRULE:FREQ=YEARLY;BYDAY=1SU;BYMONTH=11\nTZOFFSETFROM:-0500\nTZOFFSETTO:-0600\nEND:STANDARD\nBEGIN:DAYLIGHT\nDTSTART:16010311T020000\nRRULE:FREQ=YEARLY;BYDAY=2SU;BYMONTH=3\nTZOFFSETFROM:-0600\nTZOFFSETTO:-0500\nEND:DAYLIGHT\nEND:VTIMEZONE\n",t=n.querySelectorAll("center")[2].querySelectorAll("table")[1].children[0],r=(t.children,t.querySelectorAll('tr[bgcolor="#9bbad6"]')),o=[],a=0;a<r.length;a++)o.push({name:r[a].children[1].querySelector("code").textContent.trim(),details:e(r[a])});var s=0;o.forEach(function(E){var d=(new Date).toISOString().replace(/-/g,"");d=d.substring(0,d.indexOf(".")).replace(/:/g,"")+"Z",E.details.forEach(function(e){var n=e.fechas.split("al"),t=e.horario.split(" a "),r=n[0].trim().toLowerCase(),o=u(r+" "+t[1]);r+=" "+t[0];var a=n[1].trim().toLowerCase()+" "+t[1];r=u(r),a=u(a);for(var i=e.salon,c="",l=0;l<e.dias.length;l++)""!==e.dias[l].trim()&&(""!==c&&(c+=","),c+=S[l]);m+='BEGIN:VEVENT\nCLASS:PUBLIC\nCREATED:{0}\nUID:{0}-1234{7}@itesm.mx\nDESCRIPTION: Horario de Clases\\n\nDTSTART;TZID="Central Standard Time":{1}\nDTEND;TZID="Central Standard Time":{2}\nDTSTAMP:{0}\nLOCATION:{3}\nRRULE:FREQ=WEEKLY;UNTIL={4};BYDAY={5}\nSEQUENCE:0\nSUMMARY;LANGUAGE=es-mx:{6}\nTRANSP:OPAQUE\nEND:VEVENT\n'.format(d,r,o,i,a,c,E.name,T(s,2)),s++})}),m+="END:VCALENDAR",window.setTimeout(function(){!function(){m.name="calendario.ics";var e=new Blob([m],{type:"text/calendar"}),n="",t=new Date;n=6<=t.getMonth()&&t.getMonth()<12?"Ago - Dic":"Ene - Mayo",n+=" "+t.getFullYear(),anchor=document.createElement("a"),anchor.download="Horario Tec "+n+".ics",anchor.href=(window.webkitURL||window.URL).createObjectURL(e),anchor.dataset.downloadurl=["text/calendar",anchor.download,anchor.href].join(":"),anchor.click()}()},500)}())" class="btn" >Convertir Horario a Calendario</a>

    </header>

    <main id="content" class="main-content" role="main">
      <img src='tutorial.gif'>


    </main>

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-57705003-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-57705003-3');
    </script>
  </body>
</html>
