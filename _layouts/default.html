<!DOCTYPE html>
<html lang="{{ site.lang | default: "es-MX" }}">
  <head>
    <meta charset="UTF-8">

{% seo %}
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="stylesheet" href="{{ '/assets/css/style.css?v=' | append: site.github.build_revision | relative_url }}">
  </head>
  <body>

    <header class="page-header" role="banner">
      <h2 class="project-tagline">Arrastra este bot√≥n al "bookmarks bar" y dale click cuando tengas el correo del horario abierto.</h2>
      <a href='javascript:(function () {String.prototype.format||(String.prototype.format=function(){var r=arguments;return this.replace(/{(\d+)}/g,function(e,n){return void 0!==r[n]?r[n]:e})});var dayseng=["SU","MO","TU","WE","TH","FR","SA"],data="BEGIN:VCALENDAR\r\nPRODID:-//Microsoft Corporation//Outlook 16.0 MIMEDIR//EN\r\nVERSION:2.0\r\nMETHOD:PUBLISH\r\nBEGIN:VTIMEZONE\r\nTZID:Central Standard Time\r\nBEGIN:STANDARD\r\nDTSTART:16011104T020000\r\nRRULE:FREQ=YEARLY;BYDAY=1SU;BYMONTH=11\r\nTZOFFSETFROM:-0500\r\nTZOFFSETTO:-0600\r\nEND:STANDARD\r\nBEGIN:DAYLIGHT\r\nDTSTART:16010311T020000\r\nRRULE:FREQ=YEARLY;BYDAY=2SU;BYMONTH=3\r\nTZOFFSETFROM:-0600\r\nTZOFFSETTO:-0500\r\nEND:DAYLIGHT\r\nEND:VTIMEZONE\r\n",classTmpl="BEGIN:VEVENT\r\nCLASS:PUBLIC\r\nCREATED:{0}\r\nUID:{0}-1234{7}@itesm.mx\r\nDESCRIPTION: \\n\r\nDTSTART;TZID=\"Central Standard Time\":{1}\r\nDTEND;TZID=\"Central Standard Time\":{2}\r\nDTSTAMP:{0}\r\nLOCATION:{3}\r\nRRULE:FREQ=WEEKLY;UNTIL={4};BYDAY={5}\r\nSEQUENCE:0\r\nSUMMARY;LANGUAGE=en-us:{6}\r\nTRANSP:OPAQUE\r\nEND:VEVENT\r\n";function findTable(){var r=document.querySelectorAll("center");if(r.length>=3)return r[2].querySelectorAll("table")[1];for(var e=document.querySelectorAll("table"),n=0;n<e.length;n++)if("TBODY"===e[n].children[0].nodeName&&null===e[n].getAttribute("role")&&1===e[n].children[0].children.length&&2===e[n].children[0].children[0].children.length)return e[n].querySelectorAll("table")[0];return!1}function process(){var r=data,e=findTable();if(!e)return!1;var n=e.children[0],t=n.children,a=n.querySelectorAll("tr[bgcolor=\"#9bbad6\"]");if(0===a.length){a=[];for(var l=0;l<t.length;l++){var o=t[l].style.backgroundColor;""===o||"rgb(155, 186, 214)"!==o&&"#9bbad6"!==o.toLowerCase()||a.push(t[l])}}if(0===a.length)return!1;var i=[];for(l=0;l<a.length;l++)i.push({name:a[l].children[1].textContent.trim(),details:getDetails(a[l])});var s=0;return i.forEach(function(e){var n=(new Date).toISOString().replace(/-/g,"");n=n.substring(0,n.indexOf(".")).replace(/:/g,"")+"Z",e.details.forEach(function(t){var a=t.fechas.split("al"),l=t.horario.split(" a ");if(2===l.length&&2===a.length){var o=a[0].trim().toLowerCase(),i=myParser(o+" "+l[1]);o+=" "+l[0];var c=a[1].trim().toLowerCase()+" "+l[1];if(o=myParser(o),(c=myParser(c))&&o&&i){var d=t.salon;if(t.dias&&""!==t.dias.trim()){for(var u="",T=0;T<t.dias.length;T++)""!==t.dias[T].trim()&&(""!==u&&(u+=","),u+=dayseng[T]);r+=classTmpl.format(n,o,i,d,c,u,e.name,pad(s,2)),s++}}}})}),r+="END:VCALENDAR"}function pad(r,e){return("000000000"+r).substr(-e)}function myParser(r){var e=r.trim().split(" ");if(5!==e.length)return!1;var n=e[3];n+=pad({ene:1,feb:2,mar:3,abr:4,may:5,jun:6,jul:7,ago:8,sep:9,oct:10,nov:11,dic:12}[e[2]],2)+pad(e[0],2);var t=e[4].split(":");return n+="T"+pad(t[0],2)+t[1]+"00"}function replaceChars(r){var e=r.lastIndexOf("-");return r.substring(0,e).replace(/-/g,"").replace(/:/g,"")}function getDetails(r){var e=r.nextElementSibling,n=[],t=e?e.bgColor:null;for(t=(t=""===t?e.style.backgroundColor:t).toLowerCase();e&&t&&"#9bbad6"!==t&&"rgb(155, 186, 214)"!==t;){if("#eeeeee"===t||"#eee"===t||"rgb(238, 238, 238)"===t){var a,l=e.children[1].textContent.trim(),o=e.children[2].textContent,i=e.children[3].textContent.trim(),s=e.children[4].textContent.trim(),c=e.children[5].textContent.trim();"A-"==s.substr(0,2)&&(s=s.substr(2)),a=s==c?c:s+c,n.push({fechas:l,salon:a,horario:i,dias:o})}(e=e.nextElementSibling)&&(t=(t=""===(t=e?e.bgColor:null)?e.style.backgroundColor:t).toLowerCase())}return n}function downloadICS(r){var e=new Blob([r],{type:"text/calendar"});window.location.href=window.URL.createObjectURL(e)}var result=process();result?window.setTimeout(function(){downloadICS(result)},500):alert("Failed to find schedule table. Please e-mail hecerinc@gmail.com");}())' class="btn" >Convertir Horario a Calendario</a>

    </header>

    <main id="content" class="main-content" role="main">
      <img src="tutorial.gif">


    </main>

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-57705003-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-57705003-3');
    </script>
  </body>
</html>
